<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="Pop_EmpSearch" width="450" height="500" titletext="회원정보" onload="Form_onload">
    <Layouts>
      <Layout height="500" width="450">
        <Static id="Static00" taborder="0" text="회원정보" left="10" top="5" width="100" height="30" cssclass="sta_WF_emptitle" leftbase="" topbase="" bottombase="" rightbase="" widthbase="" heightbase=""/>
        <Grid id="grd_list" taborder="1" left="10" top="40" height="405" right="10" binddataset="ds_member" autofittype="col" oncelldblclick="fn_ok" leftbase="" topbase="" bottombase="" rightbase="" widthbase="" heightbase="">
          <Formats>
            <Format id="default_D">
              <Columns>
                <Column size="65"/>
                <Column size="97"/>
                <Column size="105"/>
                <Column size="146"/>
              </Columns>
              <Rows>
                <Row size="40" band="head"/>
                <Row size="40"/>
              </Rows>
              <Band id="head">
                <Cell text="SEQ"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="성명"/>
                <Cell col="3" text="연락처"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow + 1" textAlign="center"/>
                <Cell col="1" text="bind:MEMBER_NO" textAlign="center"/>
                <Cell col="2" text="bind:MEMBER_NAME" textAlign="center"/>
                <Cell col="3" text="bind:MEMBER_PHONE"/>
              </Band>
            </Format>
            <Format id="default_S">
              <Columns>
                <Column size="65"/>
                <Column size="97"/>
                <Column size="105"/>
                <Column size="146"/>
              </Columns>
              <Rows>
                <Row size="40" band="head"/>
                <Row size="40"/>
              </Rows>
              <Band id="head">
                <Cell text="선택"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="성명"/>
                <Cell col="3" text="연락처"/>
              </Band>
              <Band id="body">
                <Cell textAlign="center" displaytype="checkboxcontrol" edittype="checkbox" text="bind:CHK"/>
                <Cell col="1" text="bind:MEMBER_NO" textAlign="center"/>
                <Cell col="2" text="bind:MEMBER_NAME" textAlign="center"/>
                <Cell col="3" text="bind:MEMBER_PHONE"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_ok" taborder="3" text="OK" left="120" top="450" width="77" height="32" onclick="fn_ok" leftbase="" topbase="" bottombase="" rightbase="" widthbase="" heightbase=""/>
        <Button id="btn_cancel" taborder="2" text="Cancel" left="220" top="450" width="77" height="32" onclick="fn_cancel" leftbase="" topbase="" bottombase="" rightbase="" widthbase="" heightbase=""/>
        <CheckBox id="chk_Flag" taborder="4" text="삭제(탈퇴)" top="4" height="32" onchanged="chk_Flag_onchanged" textAlign="right" right="10" width="126"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_member">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="MEMBER_NO" type="STRING" size="32"/>
          <Column id="MEMBER_NAME" type="STRING" size="32"/>
          <Column id="MEMBER_PHONE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[this.Form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	if(String(this.parent.paramGubun) == "undefined")
	{
		this.grd_list.set_formatid("default_D");		
	} else {
		this.grd_list.set_formatid("default_" + String(this.parent.paramGubun));
	}  
	
	this.chk_Flag.set_value(false);
	this.fn_deptSearch();
};


this.fn_deptSearch = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	var args = "";
	if(this.chk_Flag.value)
	{
		args = "STATUS='0'";
	} else {
		args = "STATUS='1'";
	}  
	  
	this.gfn_transCOMMClear();   
	// input , output,args,select  
	
	  
	this.gfn_addTransInfo("","output",args,"003,Member,1");	
	var objEnv = nexacro.getEnvironment(); 

   
	var strSvcId    = "search";  
	var strSvcUrl   = "SvcURL::SqlManager/JspAgent.jsp"; 
	var inData      = "";       
	var outData     = "ds_member=output";
	var strArg      = "";       
	var callBackFnc = "fnCallback";      

	this.gfn_xtransCommon( strSvcId , 	// transaction을 구분하기 위한 svc id값
								strSvcUrl , 	// trabsaction을 요청할 주소
								inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
								outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
								strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
								callBackFnc,
								true); // 통신방법 정의 [생략가능]
};

this.fnCallback = function(svcID, errCD, errMSG)
{

	if(errCD < 0){
		this.alert("Error: " + errMSG);
	}
}

this.fn_ok = function()  
{
	var arrRtn = [];
	
	if(String(this.parent.paramGubun) == "S")
	{
		var arrCnt=0;
		for(var i=0;i<this.ds_member.rowcount;i++)
		{
			if(this.ds_member.getColumn(i,"CHK"))
			{
				arrRtn[arrCnt] =  this.ds_member.getColumn(i, "MEMBER_NO") + "|";
				arrRtn[arrCnt] += this.ds_member.getColumn(i, "MEMBER_NAME")+ "|";
				arrRtn[arrCnt] += this.ds_member.getColumn(i, "MEMBER_PHONE");  	
				arrCnt++;
			}	
		}		
	} else {
		arrRtn[0] =  this.ds_member.getColumn(this.ds_member.rowposition, "MEMBER_NO") + "|";
		arrRtn[0] += this.ds_member.getColumn(this.ds_member.rowposition, "MEMBER_NAME")+ "|";
		arrRtn[0] += this.ds_member.getColumn(this.ds_member.rowposition, "MEMBER_PHONE");  
		
	}  	
trace(arrRtn.toString());	
	this.close(arrRtn.toString());   
}           

this.fn_cancel = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.close();
};
this.chk_Flag_onchanged = function(obj:nexacro.CheckBox,e:nexacro.CheckBoxChangedEventInfo)
{
	this.fn_deptSearch();
};
]]></Script>
  </Form>
</FDL>
